<app-taskbar></app-taskbar>

<div
    class="bg"
    [class.vertical]="config.workspaceDirection == 'vertical'"
    [class.horizontal]="config.workspaceDirection == 'horizontal'"
>
    <img
        [src]="config.background"
        [style.transform]="'translate3d(' +
            (config.workspaceDirection == 'vertical' ? '0' : (-(config.currentWorkspace+1)/config.workspaces.length*50) + '%') +
            ',' +
            (config.workspaceDirection == 'horizontal' ? '0' : (-(config.currentWorkspace+1)/config.workspaces.length*50) + '%') +
        ',0)'"
    />
</div>

<!-- Root contains each workspace -->
<div
    class="root"
    [style.--maximized-width]="'calc(100% - ' + (config.leftOffset + config.rightOffset) + 'px)'"
    [style.--maximized-height]="'calc(100% - ' + (config.topOffset + config.bottomOffset) + 'px)'"
    [style.--top-offset]="config.topOffset +'px'"
    [style.--right-offset]="config.rightOffset +'px'"
    [style.--bottom-offset]="config.bottomOffset +'px'"
    [style.--left-offset]="config.leftOffset +'px'"
    >
    <!-- Dots -->
    <div
        *ngIf="showWorkspaceDots"
        class="workspace-dots"
        [@switchingWorkspace]="switchingWorkspace ? 'on' : 'off'"
    >
        <div
            *ngFor="let workspace of config.workspaces; let i = index"
            class="workspace-dot"
            [class.active]="config.currentWorkspace == i"
        ></div>
    </div>

    <ng-container *ngFor="let workspace of config.workspaces; let id = index">
        <!-- *ngIf="workspace.id == currentWorkspace" -->
        <!-- TODO: tell workspace when to hide it's children -->
        <!-- *ngIf="id >= (currentWorkspace - 1) && id <= (currentWorkspace + 1)" -->
        <app-workspace
            [workspaceId]="id"
            [background]="workspace.background"
            [@activeWorkspace]="
                id == config.currentWorkspace
                    ? 'current' :
                id < config.currentWorkspace
                    ? (config.workspaceDirection == 'vertical' ? 'above' : 'left')
                    : (config.workspaceDirection == 'vertical' ? 'below' : 'right')
            "
        >
        </app-workspace>
    </ng-container>
</div>
