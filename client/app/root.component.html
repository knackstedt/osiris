<div class="root taskbar-left">
    <div class="taskbar">
        <div class="task-button" 
            #button 
            *ngFor="let item of taskbarItems"
            >
            <div class="dots">
                <div class="dot"></div>
                <div class="dot" *ngIf="item.windows.length > 1"></div>
                <div class="dot" *ngIf="item.windows.length > 2"></div>
                <div class="dot" *ngIf="item.windows.length > 3"></div>
                <div class="dot" *ngIf="item.windows.length > 4"></div>
            </div>
            <div class="icon">
                <img [src]="item.windows[0].icon" />
            </div>

            <div class="tooltip">
                <div>
                    {{item.windows[0].description}}
                </div>
            </div>
            <!-- {{item.app}} -->
            <!-- {{item.windows.length}} -->
        </div>
    </div>
    <div class="windowManager">
        <div class="cdk-drag-boundary"></div>
        <div class="cdk-overlay-pane">
            <div 
                #window
                *ngFor="let window of managedWindows"
                class="draggable" 
                cdkDrag 
                cdkDragBoundary=".cdk-drag-boundary" 
                (cdkDragReleased)="onDragEnd(window, $event)"
                [cdkDragData]="{dragWindow: window, managedWindows, snapPx}"
                [cdkDragFreeDragPosition]="{x: window.x-64, y: window.y}"

                mwlResizable
                (resizeEnd)="onResizeEnd(window, $event)"
                (resizing)="onResizing(window, $event)"
                
                [class.active]="window._isActive"
                [class.draggedOver]="window._isDraggedOver"
                (mousedown)="activateWindow(window, $event)"
                [style.z-index]="window._index"
                [style.width]="window.width + 'px'"
                [style.height]="window.height + 'px'"
                >
                <!-- [style]="window._initialStyle" -->
            <!-- Collapsed windows will not render their contents
                -- to minimize the number of active DOM elements.
                -->
                <ng-container *ngIf="!window._isCollapsed">
                    <div class="window">
                        <div cdkDragHandle class="titlebar" >
                            <div class="other">
                                <!-- <ng-container *ngIf="titlebarTemplate; else defaultTitlebar">
                                    <ng-container *ngTemplateOutlet="titlebarTemplate"></ng-container>
                                </ng-container> -->
                    
                                <div *ngIf="window.title">{{window.title}}</div>
                                <div>
                                    x: {{window.x}}, 
                                    y: {{window.y}},
                                    width: {{window.width}},
                                    height: {{window.height}},
                                </div>
                                <!-- <ng-template #defaultTitlebar>
                                </ng-template> -->
                            </div>
                            <div class="controls">
                                <button (click)="minimizeWindow(window, $event)"><img src="assets/icons/window-minimize-symbolic.svg" /></button>
                                <button (click)="maximizeWindow(window, $event)"><img src="assets/icons/window-maximize-symbolic.svg" /></button>
                                <button class="close" (click)="closeWindow(window, $event)"><img src="assets/icons/window-close-symbolic.svg" /></button>
                            </div>
                        </div>
                        <div class="content">
                            <!-- CONTENT -->
                            <!-- {{window._isDraggedOver}} -->
                            <ng-template *ngIf="!window._isLoading" [cdkPortalOutlet]="window._portal" (attached)="injectPortal($event, window)" class="active"></ng-template>

                            <div *ngIf="window._isLoading">spinner...</div>
                        </div>
                    </div>

                    <div class="resizeHandles">
                        <div class="resize-handle-top"    mwlResizeHandle [resizeEdges]="{ top: true }"></div>
                        <div class="resize-handle-left"   mwlResizeHandle [resizeEdges]="{ left: true }"></div>
                        <div class="resize-handle-right"  mwlResizeHandle [resizeEdges]="{ right: true }"></div>
                        <div class="resize-handle-bottom" mwlResizeHandle [resizeEdges]="{ bottom: true }"></div>


                        <div class="resize-handle-top-left" mwlResizeHandle [resizeEdges]="{ top: true, left: true }"></div>
                        <div class="resize-handle-top-right" mwlResizeHandle [resizeEdges]="{ top: true, right: true }"></div>
                        <div class="resize-handle-bottom-left" mwlResizeHandle [resizeEdges]="{ bottom: true, left: true }"></div>
                        <div class="resize-handle-bottom-right" mwlResizeHandle [resizeEdges]="{ bottom: true, right: true }"></div>

                    </div>
                </ng-container>
            </div>
        </div>
    </div>
</div>

<div id="e" style="position: absolute; background: white; width: 5px; height: 5px; z-index: 90000; pointer-events: none;"></div>