<app-taskbar></app-taskbar>

<div
    class="bg"
    [class.vertical]="config.workspaceDirection == 'vertical'"
    [class.horizontal]="config.workspaceDirection == 'horizontal'"
>
    <img
        [src]="config.background"
        [style.transform]="'translate3d(' +
            (config.workspaceDirection == 'vertical' ? '0' : (-(currentWorkspace+1)/config.workspaces.length*50) + '%') +
            ',' +
            (config.workspaceDirection == 'horizontal' ? '0' : (-(currentWorkspace+1)/config.workspaces.length*50) + '%') +
        ',0)'"
    />
</div>

<!-- Root contains each workspace -->
<div class="root taskbar-{{taskbarPosition}} dir-{{config.workspaceDirection}}">
    <!-- Dots -->
    <div
        *ngIf="showWorkspaceDots"
        class="dots"
        [@switchingWorkspace]="switchingWorkspace ? 'on' : 'off'"
    >
        <div
            *ngFor="let workspace of config.workspaces; let i = index"
            class="dot"
            [class.active]="currentWorkspace == i"
        ></div>
    </div>

    <ng-container *ngFor="let workspace of config.workspaces; let id = index">
        <!-- *ngIf="workspace.id == currentWorkspace" -->
        <!-- TODO: tell workspace when to hide it's children -->
        <!-- *ngIf="id >= (currentWorkspace - 1) && id <= (currentWorkspace + 1)" -->
        <app-workspace
            [workspaceId]="id"
            [background]="workspace.background"
            [@activeWorkspace]="
                id == currentWorkspace
                    ? 'current' :
                id < currentWorkspace
                    ? (config.workspaceDirection == 'vertical' ? 'above' : 'left')
                    : (config.workspaceDirection == 'vertical' ? 'below' : 'right')
            "
        >
        </app-workspace>
    </ng-container>
</div>
